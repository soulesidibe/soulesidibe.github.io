<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
  <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-44424399-5']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Les builds flavors &middot; Soulesidibe
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body>
    <div class="container content">
      <div class="masthead">
       <h3 class="masthead-title">
    <a href="/" title="Home">Soulesidibe</a>

    
      &nbsp;&nbsp;&nbsp;
      <small><a href="/about">About</a></small>
    
      &nbsp;&nbsp;&nbsp;
      <small><a href="/archive">Archive</a></small>
    
      &nbsp;&nbsp;&nbsp;
      <small><a href="/atom.xml">Feed</a></small>
    
    </h3>
      </div>

      <div class="post">
  <h1 class="post-title">Les builds flavors</h1>
  <span class="post-date">04 Apr 2014</span>
  <blockquote>
<p>A product flavor defines a customized version of the application build by the project. A single project can have different flavors which change the generated application.</p>
</blockquote>

<p>Les builds flavors sont un puissant moyen de pouvoir travailler sur plusieurs version d&#39;une 
même application dont les différences sont trop petites pour nécessiter la création 
d&#39;une librairie.<br>
C&#39;est le cas, par exemple, quand on a une application qui doit utiliser deux bases de données 
sqlite différentes avec deux <code>ContentProvider</code> différents.<br>
Avant les build flavors, le réflexe aurait été soit de créer deux projets différents pour 
l&#39;application. Tout en prenant le risque de devoir maintenir une même base de code deux fois. 
Soit créer une librairie pour contenir toute la base de codes commune et avoir deux projets avec 
le code spécifique pour la base de données sqlite et le ContentProvider. Mais la aussi, on se retrouve 
avec trois projets a gérer.<br>
Avec les flavors, non seulement on a un seul projet mais on peut aussi avoir autant de 
ContentProvider (pour rester dans l&#39;exemple) qu&#39;on a de variantes de notre projet.</p>

<h3>Comment ca marche.</h3>

<p>Avec le concept du <code>convention over configuration</code>, on n&#39;a pas grand chose à faire pour que 
tout marche. On voit cela plus bas...</p>

<h4>Creer les dossiers sources</h4>

<p>Pour commencer,  disons qu&#39;on a deux flavors: flav1 et flav2.<br>
Au niveau du dossier src du projet gradle on doit creer deux dossiers en plus du dossier main deja présent.<br>
Et ils devront porter les noms exactes des flavors( ici flav1 et flav2). C&#39;est nouveaux dossiers ont<br>
la meme architecture que le dossier main; c&#39;est-a-dire ils peuvent ou pas contenir les dossiers <strong>java</strong>, <strong>res</strong>, etc.</p>

<p><img src="/assets/ajout_dossier.png" alt="Ajout dossier flavor"> </p>

<h4>Dire a gradle que qu&#39;il doit gérer deux flavors</h4>

<p>Dans le fichier build.gradle on doit rajouter quelques lignes pour que gradle et Android Studio puissent<br>
reconnaitre les deux flavors du module.</p>

<p><img src="/assets/gradle_config.png" alt="Ajout dossier flavor">  </p>

<p>Comme on le voit c&#39;est assez simple comme configuration. Maintenant si on a un besoin specifique on peut<br>
toujours personnaliser le flavors. Par exemple, il peux avoir un <strong>minSDKVersion</strong> different. Ou encore mieux.<br>
S&#39;il souhaite mettre l&#39;app sur le store il faudra un <strong>packageName</strong> different.</p>

<h4>Choix du flavor actif</h4>

<p>Ce qui est interessent(logique meme) avec ce mecanisme, on ne peut pas utiliser deux flavors en meme temps.<br>
Android Studio active un seul a la fois en plus du code source commun disponible dans le dossier <strong>main</strong>.<br>
Disons que flav1 est actif. Automatiquement, toutes les classes java ou ressources crees dans flav2 deviennent<br>
inactives. Cela se verifie par les couleurs des dossiers. Pour rappel, bleu pour les sources java, 
marron avec un petit icone pour les ressources et vert pour les tests.</p>

<p><img src="/assets/flavor_actif.png" alt="Ajout dossier flavor">  </p>

<p>Vous avez surement remarque que les tests ne se trouvent pas dans le dossier du flavor mais dans un dossier au niveau<br>
du dossier <strong>src</strong> et respectant la convention suivante: <code>androidTest&lt;Flavor&gt;</code>. Pour <code>flav1</code> on a <code>androidTestFlav1</code>.</p>

<p>Maintenant pour activer un flavor different, android studio nous facilite la tache avec ce menu:</p>

<p><img src="/assets/flavor_choice.png" alt="Ajout dossier flavor">  </p>

<p>expliquer le probléme(gérer différente config)</p>

<p>etat de l&#39;art avec eclipse</p>

<p>La solution de gradle dans un cas pratique</p>

<p>parler des autres possibilités</p>

<p>http://stackoverflow.com/questions/17040494/signing-product-flavors-with-gradle</p>

<p>http://tools.android.com/tech-docs/new-build-system/user-guide#TOC-Build-Type-Product-Flavor-Build-Variant</p>

<p>https://plus.google.com/+CyrilMottier/posts/Dk65EACXqsh</p>

<p>http://stackoverflow.com/questions/18328730/how-to-create-a-release-signed-apk-fiile-using-gradle</p>

<p>https://www.timroes.de/2013/09/22/handling-signing-configs-with-gradle/</p>

<p>https://plus.google.com/+JakeWharton/posts/6f5TcVPRZij</p>

<p>http://gmariotti.blogspot.com/2013/11/common-tips-about-gradle-part-2.html</p>

  <a href="https://twitter.com/intent/tweet?url=http://soulesidibe.github.io/2014/04/04/Les-builds-flavors/&text=Les builds flavors&via=soulesidibe" class="twitter-share-button" >Tweet</a>
<!-- Place this tag where you want the share button to render. -->
<div class="g-plus" data-action="share"></div>
<div class="fb-like" data-href="http://soulesidibe.github.io/2014/04/04/Les-builds-flavors/" data-layout="standard" data-action="like" data-show-faces="true" data-share="true"></div>

<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
<!-- Place this tag after the last share tag. -->
<script type="text/javascript">
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/platform.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>

<div id="fb-root"></div>
<script>(function(d, s, id) {
 var js, fjs = d.getElementsByTagName(s)[0];
 if (d.getElementById(id)) return;
 js = d.createElement(s); js.id = id;
 js.src = "//connect.facebook.net/fr_FR/all.js#xfbml=1&appId=300028946818970";
 fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2013/11/10/Linjection-de-dependances-roboguice/">
            L’injection de dépendances:roboguice
            <small>10 Nov 2013</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2013/11/01/Nexus-5-Android-kitkat-et-Android-Studio-0-3-2/">
            Nexus 5, Android kitkat et Android Studio 0.3.2
            <small>01 Nov 2013</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2013/10/15/gradle-please/">
            Gradle Please!
            <small>15 Oct 2013</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>

        <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'soulesidibe'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    
      <div class="footer">
        <p>
          &copy; 2014. All rights reserved.
        </p>
      </div>
    </div>

  </body>
</html>
